services:
  # Service pour initialiser les mod√®les
  mfa-init:
    image: mmcauliffe/montreal-forced-aligner:latest
    user: "1000:1000"
    volumes:
      - mfa-models:/mfa
    command: >
      bash -c "
      echo 'üì• T√©l√©chargement des mod√®les fran√ßais...' &&
      mfa model download acoustic french_mfa || true &&
      mfa model download dictionary french_mfa || true &&
      mfa model download acoustic english_us_arpa || true &&
      mfa model download dictionary english_us_arpa || true &&
      echo '‚úÖ Mod√®les install√©s!'
      "

  # Service principal MFA
  mfa:
    image: mmcauliffe/montreal-forced-aligner:latest
    user: "1000:1000"
    container_name: mfa-aligner
    volumes:
      - ./input:/data/input
      - ./output:/data/output
      - mfa-models:/mfa
    environment:
      - PYTHONUNBUFFERED=1
    stdin_open: true
    tty: true
    working_dir: /data/input
    depends_on:
      - mfa-init

volumes:
  mfa-models:


# Lister les mod√®les acoustiques disponibles
# mfa model list acoustic

# Lister les dictionnaires disponibles
# mfa model list dictionary